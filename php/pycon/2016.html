<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">

    <title>Streamparse - introduction to real-time data processing with Python (and some Java)</title>

    <meta name="description" content="Streamparse - introduction to real-time data processing with Python (and some Java)">
    <meta name="author" content="Pavel Grochal">

    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

    <link rel="stylesheet" href="/css/font-awesome.min.css">
    <link rel="stylesheet" href="/css/bootstrap.dark.min.css" id="theme">
    <link rel="stylesheet" href="/css/reveal.min.css">
    <link rel="stylesheet" href="/css/theme/darkless.css" id="theme">
    <link rel="stylesheet" href="/css/reveal.custom.css">



    <!-- For syntax highlighting -->
    <link rel="stylesheet" href="/lib/css/zenburn.css">

    <!-- If the query includes 'print-pdf', use the PDF print sheet -->
    <script>
        document.write( '<link rel="stylesheet" href="/css/print/' + ( window.location.search.match( /print-pdf/gi ) ? 'pdf' : 'paper' ) + '.css" type="text/css" media="print">' );

        function writeProject() {
            let text = `
                    <ul class="tree">
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                    <ul>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                    <ul>
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                    <ul>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                    </ul>
                    </li>
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                    <ul>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                    </ul>
                    </li>
                    </ul>
                    </li>
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                    <ul>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                    </ul>
                    </li>
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                    <ul>
                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                    </ul>
                    </li>
                    </ul>
                    </li>
                    </ul>`;
            document.write(text);
        }
    </script>

    <!--[if lt IE 9]>
    <script src="/lib/js/html5shiv.js"></script>
    <![endif]-->
</head>

<body>

<div class="reveal">

    <!-- Any section element inside of this container is displayed as a slide -->
    <div class="slides">

        <section>
            <h1 class="streamparse-logo-blue-light">Streamparse</h1>
            <h3>Introduction to real-time data processing</h3>
            <h4>with Python (and some Java)</small></h4>
            <hr>
            <a href="http://slides.darkless.cz/pycon/2016.html">http://slides.darkless.cz/pycon/2016.html</a>
        </section>

        <section>
            <h1>Pavel Grochal</h1>
            <hr>
            <div>
                <div class="pull-right" style="margin-top: 50px">
                    <ul>
                        <li>Open-source enthusiast</li>
                        <li>Python language lover</li>
                        <li>Lazy programmer</li>
                            <ul style="list-style: none;"><li class="text-muted">(read: "There has to be an easier way!")</li></ul>
                        <li>Detail freak</li>
                    </ul>
                </div>
                <div class="pull-left" style="width:260px"><img style="border: none; background-color: transparent;box-shadow:none;" src="/pycon/img/inuits.png" alt="Storm flow"></div>
            </div>
        </section>

        <section>
            <h2>Motivation:</h2>
            <hr>
            <h3>We needed to process (a lot of) real-time GPS data.</h3>
        </section>

        <section>
            <section>
                <h2>What is Apache Storm?</h2>
                <p><img src="/pycon/img/apache-storm-logo.png" alt="" style="background-color: #fff"></p>
                <p><a href="http://storm.apache.org/" target="_blank">http://storm.apache.org/</a></p>
            </section>

            <section>
                <blockquote class="big" style="line-height: 1.4em">"<b>Apache Storm is a free and open source distributed real-time
                    computation system.</b>"</blockquote>
                <p>-- <a href="http://storm.apache.org/" target="_blank">http://storm.apache.org/</a></p>
            </section>
            <section>
                <!--<h2>Storm Cluster</h2>-->
                <img src="/pycon/img/storm-cluster.png" alt="Apache Storm Cluster" style="border: none; background: none; height: 500px;">
            </section>
            <section>
                <!--<h2>Worker Process</h2>-->
                <img src="/pycon/img/storm-worker.png" alt="Apache Storm workers" style="border: none; background: none;">
            </section>
            <section>
                <h2>Storm Abstractions</h2>
                <ul>
                    <li>Tuple</li>
                    <li>Spout</li>
                    <li>Bolt</li>
                    <li>Topology</li>
                </ul>
            </section>
            <section>
                <h3>How does processing in Apache Storm work?</h3>
                <img src="/pycon/img/storm-topology.png" alt="Storm flow" style="border: none; background-color: #ddd;">
            </section>
        </section>

        <section>
            <h2>Process outline:</h2>
            <ol>
                <li>Read data from RabbitMQ</li>
                <li>Process the data</li>
                <li>Store data in DB</li>
            </ol>
        </section>

        <section>
            <section>
                <div>
                    <h2>How does <span class="streamparse-logo-blue-light">Streamparse</span> fit in?</h2>
                    <p><img src="/pycon/img/streamparse-logo.png" alt="" style="background-color: #fff; height: 150px;"></p>
                    <a href="https://streamparse.readthedocs.io/en/stable/index.html#">https://streamparse.readthedocs.io/en/stable/index.html#</a>
                    <hr>
                    <p class="text-muted">Maintained by:</p>
                    <p><img src="/pycon/img/parsely.png" alt="" style="background-color: #fff; height: 100px;"></p>
                </div>
            </section>

            <section>
                <h2>Dependencies</h2>
                <ul>
                    <li>JDK 7+</li>
                    <ul>
                        <li>via package-manager</li>
                    </ul>
                    <li>Leiningen</li>
                    <ul>
                        <li>install script (wget)</li>
                        <li>add to PATH</li>
                    </ul>
                    <li>Apache Storm development environment</li>
                    <ul>
                        <li>download package (.zip/.tar.gz)</li>
                        <li>add bin folder to PATH</li>
                    </ul>
                </ul>
                <hr>
                <a href="https://streamparse.readthedocs.io/en/stable/quickstart.html#dependencies">https://streamparse.readthedocs.io/en/stable/quickstart.html#dependencies</a>
            </section>

            <section>
                <h2><span class="streamparse-logo-blue-light">Streamparse</span> quickstart</h2>
                <h4><span class="orange">sparse</span> - cli tool from streamparse</h4>
                <div class=""><pre><code class="orange" data-trim contenteditable contextmenu>
> sparse quickstart wordcount
> cd wordcount
                </code></pre></div>
                <div style="position: relative">
                    <pre><code class="bash" data-trim contenteditable contextmenu>
Creating your wordcount streamparse project...
    create    wordcount
    create    wordcount/.gitignore
    create    wordcount/config.json
    create    wordcount/fabfile.py
    create    wordcount/project.clj
    create    wordcount/README.md
    create    wordcount/src
    create    wordcount/src/bolts/
    create    wordcount/src/bolts/__init__.py
    create    wordcount/src/bolts/wordcount.py
    create    wordcount/src/spouts/
    create    wordcount/src/spouts/__init__.py
    create    wordcount/src/spouts/words.py
    create    wordcount/topologies
    create    wordcount/topologies/wordcount.py
    create    wordcount/virtualenvs
    create    wordcount/virtualenvs/wordcount.txt
Done.
                </code></pre>
                    <div style="position:absolute; right:0; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <script>writeProject();</script>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="topology-green"><i class="fa fa-file-text" aria-hidden="true"></i> src/spouts/words.py</h2>
                <hr>
                <div style="position: relative">
                <div><pre><code class="python" data-trim contenteditable contextmenu>
from itertools import cycle

from streamparse import Spout


class WordSpout(Spout):
    outputs = ['word']

    def initialize(self, stormconf, context):
        self.words = cycle(['dog', 'cat', 'zebra', 'elephant'])

    def next_tuple(self):
        word = next(self.words)
        self.emit([word])
                </code></pre></div>

                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="topology-green"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="topology-teal"><i class="fa fa-file-text" aria-hidden="true"></i> src/bolts/wordcount.py</h2>
                <hr>
                <div style="position: relative">
                    <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
    from collections import Counter

    from streamparse import Bolt


    class WordCountBolt(Bolt):
        outputs = ['word', 'count']

        def initialize(self, conf, ctx):
            self.counts = Counter()

        def process(self, tup):
            word = tup.values.word
            # word = tup.values[0]

            self.counts[word] += 1
            self.logger.info("{}:{}".format(word, self.counts[word]))

            self.emit([word, self.counts[word]])
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2 class="topology-red"><i class="fa fa-file-text" aria-hidden="true"></i> topologies/wordcount.py</h2>
                <hr>
                <div style="position: relative">
                    <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
    from streamparse import Grouping, Topology

    from spouts.words import WordSpout
    from bolts.wordcount import WordCountBolt


    class WordCount(Topology):
        word_spout = WordSpout.spec()

        count_bolt = WordCountBolt.spec(
            inputs={word_spout: Grouping.fields('word')},
            par=2)
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li class="topology-red"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2><span class="streamparse-logo-blue-light">Streamparse</span> visualize</h2>
                <div class=""><pre><code class="orange" data-trim contenteditable contextmenu>
> sparse visualize
                </code></pre></div>
                <hr>
                <h4>Directed Acyclic Graph (DAG)</h4>
                <p><img src="/pycon/img/wordcount.png" alt="Wordcount topology visualization" style="border-width: 1px"></p>
                <p class="text-muted">wordcount.png</p>
            </section>

            <section>
                <h2>The other files</h2>
                <hr>
                <ul class="tree">
                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                        <ul>
                            <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                            <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                            <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                <ul>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                            <li class="topology-teal"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                            <li class="topology-green"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                <ul>
                                    <li class="topology-red"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                </ul>
                            </li>
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                <ul>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> config.json</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="json" data-trim contenteditable contextmenu>
{
    "serializer": "json",
    "topology_specs": "topologies/",
    "virtualenv_specs": "virtualenvs/",
    "envs": {
        "prod": {
            "user": "",
            "ssh_password": "",
            "nimbus": "",
            "workers": [],
            "log": {
                "path": "",
                "max_bytes": 1000000,
                "backup_count": 10,
                "level": "info"
            },
            "virtualenv_root": ""
        }
    }
}
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> fabfile.py</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
def pre_submit(topology_name, env_name, env_config):
    """Override this function to perform custom actions prior
    to topology submission. No SSH tunnels will be active when
    this function is called."""
    pass


def post_submit(topo_name, env_name, env_config):
    """Override this function to perform custom actions after
    topology submission. Note that the SSH tunnel to Nimbus
    will still be active when this function is called."""
    pass

                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> project.clj</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
(defproject wordcount "0.0.1-SNAPSHOT"
  :resource-paths ["_resources"]
  :target-path "_build"
  :min-lein-version "2.0.0"
  :jvm-opts ["-client"]
  :dependencies  [[org.apache.storm/storm-core "1.0.2"]
                  [org.apache.storm/flux-core "1.0.2"]]
  :jar-exclusions     [ #"log4j\.properties"
                        #"org\.apache\.storm\.(?!flux)"
                        #"trident"
                        #"META-INF"
                        #"meta-inf"
                        #"\.yaml"
                        ]
  :uberjar-exclusions [ #"log4j\.properties"
                        #"org\.apache\.storm\.(?!flux)"
                        #"trident"
                        #"META-INF"
                        #"meta-inf"
                        #"\.yaml"
                        ]
  )
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> virtualenvs/wordcount.txt</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="python" contenteditable contextmenu># pip requirements.txt file
streamparse # always required for streamparse projects

# other pip dependencies








                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li class="streamparse-logo-blue-dark"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li class="streamparse-logo-blue-dark"><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <section>
                <h2>Running <span class="streamparse-logo-blue-light">Streamparse</span> localy</h2>
                <div class=""><pre><code class="orange" data-trim contenteditable contextmenu>
> sparse run
                </code></pre></div>
                <div><pre><code class="bash" data-trim contenteditable contextmenu style="max-height: none">
Cleaning from prior builds...
Creating topology Uber-JAR...

                    ...

---------- TOPOLOGY DETAILS ----------
Topology Name: wordcount
--------------- SPOUTS ---------------
word_spout [1] (org.apache.storm.flux.wrappers.spouts.FluxShellSpout)
---------------- BOLTS ---------------
count_bolt [1] (org.apache.storm.flux.wrappers.bolts.FluxShellBolt)
--------------- STREAMS ---------------
word_spout --FIELDS--> count_bolt
--------------------------------------

                    ...

7556 [Thread-21] INFO  o.a.s.t.ShellBolt - ShellLog pid:17965, name:count_bolt
      2016-10-23 14:14:24,403 - pystorm.component.count_bolt - zebra:1263

7556 [Thread-21] INFO  o.a.s.t.ShellBolt - ShellLog pid:17965, name:count_bolt
      2016-10-23 14:14:24,403 - pystorm.component.count_bolt - elephant:1263

7556 [Thread-21] INFO  o.a.s.t.ShellBolt - ShellLog pid:17965, name:count_bolt
      2016-10-23 14:14:24,403 - pystorm.component.count_bolt - dog:1264

7565 [Thread-21] INFO  o.a.s.t.ShellBolt - ShellLog pid:17965, name:count_bolt
      2016-10-23 14:14:24,412 - pystorm.component.count_bolt - cat:1264
                </code></pre></div>

            </section>

        </section>

        <section>
            <h2>How does <span class="streamparse-logo-blue-light">Streamparse</span></h2>
            <h3>talk with Apache Storm?</h3>
        </section>

        <section>
            <section>
                <h2>Running <span class="streamparse-logo-blue-light">Streamparse</span> localy</h2>
                <h4>sparse run</h4>
                <div>
                    <img src="/pycon/img/streamparse-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle"> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">Flux</span></div> <span class="big">&rarr;</span>
                    <img src="/pycon/img/apache-storm-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle">
                </div>
            </section>

            <section>
                <h2>Flux</h2>
                <blockquote style="line-height: 1.2em">"A framework for creating and deploying <br>
                    Apache Storm streaming computations with less friction."</blockquote>
                <a href="http://storm.apache.org/releases/2.0.0-SNAPSHOT/flux.html">http://storm.apache.org/releases/2.0.0-SNAPSHOT/flux.html</a>
            </section>

            <section>
                <h2>How to run Flux</h2>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
storm jar mytopology.jar org.apache.storm.flux.Flux --local config.yaml
                </code></pre></div>
                <p>or</p>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
storm jar mytopology.jar org.apache.storm.flux.Flux --remote config.yaml
                </code></pre></div>
                <hr>
                <h4>Files needed:</h4>
                <ul>
                    <li>mytopology.jar</li>
                    <li>config.yaml</li>
                </ul>
            </section>

            <section>
                <h2>sparse run</h2>
                <h4><span class="text-muted"> > running streamparse/cli/run.py</span></h4>
                <div class=""><pre><code class="markdown" data-trim contenteditable contextmenu>
> sparse run
                </code></pre></div>
                <div class=""><pre><code class="markdown" data-trim contenteditable contextmenu>
Cleaning from prior builds...

Creating topology Uber-JAR...

Uber-JAR created: /home/darkless/projects/sparse/wordcount/_build/wordcount-0.0.1-SNAPSHOT-standalone.jar

Removing _resources temporary directory...done

[localhost] local: storm jar /home/darkless/projects/sparse/wordcount/_build/wordcount-0.0.1-SNAPSHOT-standalone.jar org.apache.storm.flux.Flux --local --no-splash --sleep 9223372036854775807 /tmp/tmpj_EZMO.yaml

SLF4J: Class path contains multiple SLF4J bindings.
                </code></pre></div>
                <ol>
                    <li>Topology (Uber-)JAR</li>
                    <ul style="list-style-type: none;: none">
                        <li class="text-muted">wordcount/_build/wordcount-0.0.1-SNAPSHOT-standalone.jar</li>
                    </ul>
                    <li>Temporary local .yaml file</li>
                    <ul style="list-style-type: none;: none">
                        <li class="text-muted">/tmp/tmpj_EZMO.yaml</li>
                    </ul>
                </ol>
            </section>

            <section>
                <h3><i class="fa fa-file-text" aria-hidden="true"></i> wordcount-0.0.1-SNAPSHOT-standalone.jar</h3>
                <hr>
                <h4>Contains (among other things):</h4>
                <ul>
                    <li>java libraries - apache storm and others</li>
                    <li>all python code in <b>src/</b> folder</li>
                    <li>project.clj</li>
                </ul>
            </section>

            <section>
                <h2><i class="fa fa-file-text" aria-hidden="true"></i> /tmp/tmpj_EZMO.yaml</h2>
                <div class=""><pre><code class="yaml" data-trim contenteditable contextmenu style="max-height: none;">
bolts:
- className: org.apache.storm.flux.wrappers.bolts.FluxShellBolt
    constructorArgs:
    - [streamparse_run, bolts.wordcount.WordCountBolt]
    - [word, count]
    id: count_bolt

config: { pystorm.log.backup_count: 10, pystorm.log.level: info,
  pystorm.log.max_bytes: 1000000, topology.acker.executors: 0,
  topology.python.path: /wordcount/bin/python, topology.workers: 1 }

name: wordcount

spouts:
- className: org.apache.storm.flux.wrappers.spouts.FluxShellSpout
    constructorArgs:
    - [streamparse_run, spouts.words.WordSpout]
    - [word]
    id: word_spout

streams:
- from: word_spout
    grouping:
        args: [word]
        streamId: default
        type: FIELDS
    to: count_bolt
                </code></pre></div>
            </section>

            <section>
                <div>
                    <img src="/pycon/img/streamparse-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle"> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">Flux</span></div> <span class="big">&rarr;</span>
                    <img src="/pycon/img/apache-storm-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle">
                </div>
            </section>

        </section>

        <section>
            <section>
                <h2>Running <span class="streamparse-logo-blue-light">Streamparse</span> on cluster</h2>
                <h4>sparse submit</h4>
                <div>
                    <img src="/pycon/img/streamparse-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle"> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">ThriftPy</span></div> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">Flux</span></div> <span class="big">&rarr;</span>
                    <img src="/pycon/img/apache-storm-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle">
                </div>
            </section>

            <section>
                <h2>What Apache Storm says?</h2>
                <blockquote style="line-height: 1.2em">"At the core of Storm is a Thrift definition for defining and submitting topologies. Since Thrift can be used in any language, topologies can be defined and submitted from any language."</blockquote>
                <p>-- <a href="https://storm.apache.org/about/multi-language.html">https://storm.apache.org/about/multi-language.html</a></p>
            </section>

            <section>
                <h2>Thrift</h2>
                <blockquote class="big" style="line-height: 1.4em">"The Apache Thrift is software framework for scalable cross-language services development."</blockquote>
                <p>-- <a href="https://thrift.apache.org/">https://thrift.apache.org/</a></p>
            </section>

            <section>
                <h2>ThriftPy</h2>
                <blockquote class="big" style="line-height: 1.4em">"ThriftPy is a pure python implementation of Apache Thrift in a pythonic way."</blockquote>
                <p>-- <a href="https://thriftpy.readthedocs.io/en/latest/">https://thriftpy.readthedocs.io/en/latest/</a></p>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> config.json</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="json" data-trim contenteditable contextmenu style="max-height: none">
{
    "serializer": "json",
    "topology_specs": "topologies/",
    "virtualenv_specs": "virtualenvs/",
    "envs": {
        "prod": {
            "user": "remote_user",
            "ssh_password": "remote_password",
            "nimbus": "my1.apache.storm.cluster",
            "workers": [
                "my1.apache.storm.cluster",
                "my2.apache.storm.cluster"
            ],
            "log": {
                "path": "",
                "max_bytes": 1000000,
                "backup_count": 10,
                "level": "info"
            },
            "virtualenv_root": "/opt/storm/storm-virtualenv/"
        }
    }
}
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <div><span class="text-muted">Note:</span> <br>
                    <ul class="text-muted" style="list-style-type: none">
                        <li>
                            envs . prod . *
                        </li>
                    </ul>
                </div>
            </section>

            <section>
                <h2>sparse submit</h2>
                <h4><span class="text-muted">> running streamparse/cli/submit.py</span></h4>
                <div class=""><pre><code class="markdown" data-trim contenteditable contextmenu>
> sparse submit -e prod -n wordcount
                </code></pre></div>
                <div class=""><pre><code class="markdown" data-trim contenteditable contextmenu>
Cleaning from prior builds...
Creating topology JAR...
JAR created: /home/darkless/projects/sparse/wordcount/_build/wordcount-0.0.1-SNAPSHOT-standalone.jar
Removing _resources temporary directory...done
Deploying "wordcount" topology...
ssh tunnel to Nimbus my.apache.storm.cluster:6627 established.
Uploading requirements.txt to temporary file.
Updating virtualenv: wordcount

                    HERE `pip install -r tmpfile_name --exists-action w`

Uploading topology jar /var/lib/jenkins/jobs/topology-checkout-intercad/workspace/intercad/_build/intercad_topology-0.0.1-SNAPSHOT.jar to assigned location: /var/lib/storm/nimbus/inbox/stormjar-d1106289-b417-4c36-ac78-459f3aa35cfb.jar
Uploaded 0/53031 bytes
Uploaded 53031/53031 bytes
Uploaded 53031/53031 bytes
Routing Python logging to None.
Submitting intercad-topology topology to nimbus...done
                </code></pre></div>
            </section>

            <section>
                <h3>Depoloying "wordcount" topology...</h3>
                <h4><span><i class="fa fa-file-text" aria-hidden="true"></i> streamparse/cli/submit.py</span></h4>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu style="max-height: none">
...

def submit_topology(name=None, env_name=None, options=None, force=False,
                    wait=None, simple_jar=True, override_name=None):
    """Submit a topology to a remote Storm cluster."""

    ...

    print('Deploying "{}" topology...'.format(name))

    # Use ssh tunnel with Nimbus if use_ssh_for_nimbus is unspecified or True
    with ssh_tunnel(env_config) as (host, port):
        nimbus_client = get_nimbus_client(env_config, host=host, port=port)
        uploaded_jar = _upload_jar(nimbus_client, topology_jar)
        _kill_existing_topology(override_name, force, wait, nimbus_client)
        _submit_topology(override_name, topology_class, uploaded_jar, config,
        env_config, nimbus_client, options=options)
    _post_submit_hooks(name, env_name, env_config)

    ...
...
                    </code></pre></div>
            </section>

            <section>
                <div>
                    <img src="img/streamparse-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle"> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">ThriftPy</span></div> <span class="big">&rarr;</span>
                    <div style="display: inline-block; border: 2px solid #fff; width: 200px; line-height: 70px; height: 70px; background-color: #fff; vertical-align: middle"><span class="streamparse-logo-blue-dark">Flux</span></div> <span class="big">&rarr;</span>
                    <img src="img/apache-storm-logo.png" alt="Streamparse logo" style="height: 70px; background-color: #fff; vertical-align: middle">
                </div>
            </section>
        </section>

        <section>
            <section>
                <h2>Custom configuration options</h2>
            </section>
            <section>
                <h2>Virtualenv and Topology-level Settings</h2>
                <h4><i class="fa fa-file-text" aria-hidden="true"></i> config.json</h4>
                <div class=""><pre><code class="json" data-trim contenteditable contextmenu style="max-height: none">
{   "library": "",
    "topology_specs": "topologies/",
    "virtualenv_specs": "virtualenvs/",
    "envs": {
        "prod": {
            "user": "remote_user",
            "ssh_password": "remote_password",
            "nimbus": "my1.apache.storm.cluster",
            "workers": [
                "my1.apache.storm.cluster",
                "my2.apache.storm.cluster"
            ],
            "log": {
                "path": "",
                "max_bytes": 1000000,
                "backup_count": 10,
                "level": "info"
            },
            "virtualenv_root": "/opt/storm/storm-virtualenv",
            "use_virtualenv": true,
            "install_virtualenv": false,
            "worker_count": 3,
            "acker_count": 3,
            "options":{
                "topology.max.spout.pending": 12,
                "my.other.custom.configuration": true
            }
        }
    }
}

                </code></pre></div>
            </section>
            <section>
                <h2>Bolt/Spout custom options</h2>
                <h4><i class="fa fa-file-text" aria-hidden="true"></i> topologies/super_topology.py</h4>
                <div class=""><pre><code class="json" data-trim contenteditable contextmenu style="max-height: none">
rabbitmq_incoming_spout = RabbitMQSpout.spec(
    name='rabbitmq_incoming_spout',
    par=1,
    config={
        "rabbitmq.url": "amqp://user:password@host_name:5672/vhost"
        "rabbitmq.queues": ["my_first_queue", "my_second_queue"]
    }
)
                </code></pre></div>
                <hr>
                <h4><i class="fa fa-file-text" aria-hidden="true"></i> src/bolts/RabbitMQSpout.py</h4>
                <div class=""><pre><code class="json" data-trim contenteditable contextmenu style="max-height: none">
from streamparase.storm import Spout


class RabbitMQSpout(Spout):

    def initialize(self, stormconf, context):
        rabbitmq_url = stormconf.get("rabbitmq.url")
        rabbitmq_queues = stormconf.get("rabbitmq.queues")

        topology_level_option = stormconf.get("my.other.custom.configuration")
        ...

    def process(self, tup):
        ...

                </code></pre></div>
            </section>

        </section>

        <section>
            <section>
                <h2>Mixing topologies</h2>
                <h3><span class="text-muted">(Python + Java components)</span></h3>
                <a href="https://streamparse.readthedocs.io/en/stable/topologies.html#java-components">https://streamparse.readthedocs.io/en/stable/topologies.html#java-components</a>
            </section>
            <section>
                <h2>Mixing topologies - example</h2>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu style="max-height: none">
"""
Pixel count topology
"""

from streamparse import Grouping, JavaSpout, Topology

from bolts.pixel_count import PixelCounterBolt
from bolts.pixel_deserializer import PixelDeserializerBolt


class PixelCount(Topology):
    pixel_spout = JavaSpout.spec(name="pixel-spout",
                                 full_class_name="pixelcount.spouts.PixelSpout",
                                 args_list=[],
                                 outputs=["pixel"])
    pixel_deserializer = PixelDeserializerBolt.spec(name='pixel-deserializer-bolt',
                                                    inputs=[pixel_spout])
    pixel_counter = PixelCounterBolt.spec(name='pixel-count-bolt',
                                          inputs={pixel_deserializer:
                                                  Grouping.fields('url')},
                                          config={"topology.tick.tuple.freq.secs": 1})
                </code></pre></div>
            </section>
        </section>

        <section>

            <section>
                <h3>How does Python Process get spawned?</h3>
                <hr>
                <p><span>Apache Storm Cluster (Worker)</span></p>
                <p>&darr;</p>
                <p><span>FluxShellSpout (extends ShellSpout)</span></p>
                <p>&darr;</p>
                <p><span>Spawn Python process</span></p>
                <p><span class="text-muted">(which communicates via STDIN / STDOUT)</span><p>
                <p class="text-muted"><a href="http://storm.apache.org/releases/1.0.2/Multilang-protocol.html">http://storm.apache.org/releases/1.0.2/Multilang-protocol.html</a></p>
            </section>

            <section>
                <h2>Including custom FluxShellBolt/FluxShellSpout</h2>
            </section>

            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> streamparse/dsl/topology.py</h2>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
...
@staticmethod
def _spec_to_flux_dict(spec):
    """Convert a ComponentSpec into a dict as expected by Flux"""
    flux_dict = {'id': spec.name,
                 'constructorArgs': []}
    if isinstance(spec, ShellComponentSpec):
        if isinstance(spec, ShellBoltSpec):
            flux_dict['className'] = \
                    'org.apache.storm.flux.wrappers.bolts.FluxShellBolt'
        else:
            flux_dict['className'] = \
                    'org.apache.storm.flux.wrappers.spouts.FluxShellSpout'
        shell_object = spec.component_object.shell
        flux_dict['constructorArgs'].append([shell_object.execution_command,
                                             shell_object.script])
                        ...
    ...
    return flux_dict
...
                </code></pre></div>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
print flux_dict

{'className': 'org.apache.storm.flux.wrappers.bolts.FluxShellBolt',
 'constructorArgs':
     [['streamparse_run', 'bolts.wordcount.WordCountBolt'], ['word', 'count']],
 'id': 'count_bolt'}

{'className': 'org.apache.storm.flux.wrappers.spouts.FluxShellSpout',
 'constructorArgs':
     [['streamparse_run', 'spouts.words.WordSpout'], ['word']],
 'id': 'word_spout'}
                </code></pre></div>
            </section>

            <section>
                <h3>FluxShellSpout.java</h3>
                <h4><span class="text-muted">org/apache/storm/flux/wrappers/spouts/FluxShellSpout.java</span></h4>
                <p><a target="_blank" href="https://github.com/apache/storm/blob/master/external/flux/flux-wrappers/src/main/java/org/apache/storm/flux/wrappers/spouts/FluxShellSpout.java">(Source code link)</a></p>
                <hr>
                <h3>FluxShellBolt.java</h3>
                <h4><span class="text-muted">org/apache/storm/flux/wrappers/bolts/FluxShellBolt.java</span></h4>
                <p><a target="_blank" href="https://github.com/apache/storm/blob/master/external/flux/flux-wrappers/src/main/java/org/apache/storm/flux/wrappers/bolts/FluxShellBolt.java">(Source code link)</a></p>
            </section>

            <section>
                <h2>Including Java Files</h2>
                <ul class="tree large">
                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                        <ul>
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> java_deps
                                <ul>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> org/apache/storm/flux/wrappers/
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> XFluxShellSpout.java</li>
                                                </ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> XFluxShellBolt.java</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                <ul>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                <ul>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                </ul>
                            </li>
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                <ul>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                </ul>
                            </li>
                        </ul>
                    </li>
                </ul>
            </section>

            <section>
              <h3><i class="fa fa-file-text" aria-hidden="true"></i> XFluxShellSpout.java - example</h3>
              <div class=""><pre><code class="java" data-trim contenteditable contextmenu style="max-height: none">
package org.apache.storm.flux.wrappers.spouts;

import org.apache.storm.flux.wrappers.spouts.FluxShellSpout;

public class XFluxShellSpout extends FluxShellSpout implements IRichSpout {

    /**
     * Create a ShellSpout with command line arguments
     * @param command Command line arguments for the spout
     */
    public XFluxShellSpout(String[] command){
        super(command);
        this.customVariable = True
    }

    ...
}
              </code></pre></div>
            </section>
            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> project.clj</h2>
                <div style="position: relative">
                    <div class=""><pre><code class="python" data-trim contenteditable contextmenu style="max-height: none">
(defproject wordcount "0.0.1-SNAPSHOT"
  :resource-paths ["_resources"]
  :target-path "_build"
  :min-lein-version "2.0.0"
  :jvm-opts ["-client"]
  :dependencies  [[org.apache.storm/storm-core "1.0.2"]
                  [org.apache.storm/flux-core "1.0.2"]]
  :jar-exclusions     [ #"log4j\.properties"
                        #"org\.apache\.storm\.(?!flux)"
                        #"trident"
                        #"META-INF"
                        #"meta-inf"
                        #"\.yaml"
                        ]
  :uberjar-exclusions [ #"log4j\.properties"
                        #"org\.apache\.storm\.(?!flux)"
                        #"trident"
                        #"META-INF"
                        #"meta-inf"
                        #"\.yaml"
                        ]
  :java-source-paths ["java_deps"]
  )
                    </code></pre></div>
                    <div style="position:absolute; right:-100px; top:0px; z-index:999; border:2px solid #00B1DE; padding:5px; font-size:0.7em; background-color:#212121;">
                        <ul class="tree">
                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount
                                <ul>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> java_deps
                                        <ul>
                                            <li>...</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> config.json</li>
                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> fabfile.py</li>
                                    <li class="topology-white"><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> project.clj</li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> src
                                        <ul>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> bolts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                                </ul>
                                            </li>
                                            <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> spouts
                                                <ul>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> __init__.py</li>
                                                    <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> words.py</li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> topologies
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.py</li>
                                        </ul>
                                    </li>
                                    <li><i class="fa fa-folder-o streamparse-logo-blue-dark" aria-hidden="true"></i> virtualenvs
                                        <ul>
                                            <li><i class="fa fa-file-text streamparse-logo-blue-dark" aria-hidden="true"></i> wordcount.txt</li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
                <p><span class="text-muted">Note:</span> <br>
                    <b>:java-source-paths ["java_deps"]</b>
            </section>
            <section>
                <h2 class=""><i class="fa fa-file-text" aria-hidden="true"></i> Changing</h2>
                <h4>streamparse/dsl/topology.py</h4>
                <hr>
                <h4><span class="text-muted">genetaring .yaml file</span></h4>
                <div class=""><pre><code class="python" data-trim contenteditable contextmenu>
...
@staticmethod
def _spec_to_flux_dict(spec):
    """Convert a ComponentSpec into a dict as expected by Flux"""
    flux_dict = {'id': spec.name,
                 'constructorArgs': []}
    if isinstance(spec, ShellComponentSpec):
        if isinstance(spec, ShellBoltSpec):
            flux_dict['className'] = \
                    'org.apache.storm.flux.wrappers.bolts.XFluxShellBolt'
        else:
            flux_dict['className'] = \
                    'org.apache.storm.flux.wrappers.spouts.XFluxShellSpout'
        shell_object = spec.component_object.shell
        flux_dict['constructorArgs'].append([shell_object.execution_command,
                                             shell_object.script])
                        ...
    ...
    return flux_dict
...
                </code></pre></div>
                <p><span class="text-muted">Note:</span> <br>
                    <b>XFluxShellBolt</b><br>
                    <b>XFluxShellSpout</b></p>
            </section>

            <section>
                <p><span>Apache Storm Cluster (Worker)</span></p>
                <p>&darr;</p>
                <p><span>XFluxShellSpout</span></p>
                <p>&darr;</p>
                <p><span>Spawn Python process</span></p>
            </section>
        </section>


        <section>
            <h2>Thank you for your attention!</h2>
        </section>


    </div>

</div>

<script src="/lib/js/head.min.js"></script>
<script src="/js/reveal.min.js"></script>

<script>

    // Full list of configuration options available here:
    // https://github.com/hakimel/reveal.js#configuration
    Reveal.initialize({
        controls: true,
        progress: true,
        history: true,
        center: true,

        theme: Reveal.getQueryHash().theme, // available themes are in //css/theme
        transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

        // Optional libraries used to extend on reveal.js
        dependencies: [
            { src: '../lib/js/classList.js', condition: function() { return !document.body.classList; } },
            { src: '../plugin/markdown/showdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: '../plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
            { src: '../plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
            { src: '../plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
            { src: '../plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
            //{ src: 'plugin/remotes/remotes.js', async: true, condition: function() { return !!document.body.classList; } }
        ]
    });

</script>

</body>
</html>
